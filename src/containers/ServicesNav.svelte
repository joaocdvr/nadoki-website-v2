<script>
  import { onMount, afterUpdate } from "svelte";
  import { get } from "svelte/store";
  import { fade } from "svelte/transition";
  import {
    animationInDelay,
    animationInDuration,
    animationInEasing,
    animationOutDuration,
    animationOutEasing,
    servicesModalActive,
    setServicesModalActive,
    handleServicesModalClick,
    musicActiveTab,
    setActiveMusicTab,
    handleMusicTabClick,
    filmActiveTab,
    setActiveFilmTab,
    handleFilmTabClick,
    gameActiveTab,
    setActiveGameTab,
    handleGameTabClick,
    brandingActiveTab,
    setActiveBrandingTab,
    handleBrandingTabClick
  } from "../utensils/stores.js";
  import { handleSVGAnimation } from "../utensils/utils.js";

  afterUpdate(() => {
    handleSVGAnimation("svg-to-animate-music", "services", "name", null);
    handleSVGAnimation("svg-to-animate-film", "services", "name", null);
    handleSVGAnimation("svg-to-animate-game", "services", "name", null);
    handleSVGAnimation("svg-to-animate-branding", "services", "name", null);
  });
</script>

<style>
  menu {
    line-height: 0;
    min-height: calc((var(--vh, 1vh) * 100) - 11rem);
    display: flex;
    flex-wrap: wrap;
  }

  @media (--max-content-width) {
    menu {
      flex-wrap: nowrap;
      min-height: calc((var(--vh, 1vh) * 100) - 12.5rem);
    }
  }

  button {
    position: relative;
    cursor: pointer;
    width: 50%;
    padding: 1.5rem;
    background-color: var(--main-color);
    transition: background-color 300ms ease-in-out, color 300ms ease-in-out;
  }

  :global(.user-is-tabbing) button:focus .text-svg {
    fill: var(--light);
  }

  :global(.user-is-tabbing) button:focus .icon-svg {
    fill: var(--secondary-color);
  }

  @media (--not-touchscreen) {
    button:hover .text-svg {
      fill: var(--light);
    }

    button:hover .icon-svg {
      fill: var(--secondary-color);
    }
  }

  svg {
    position: absolute;
    width: calc(100% - 3rem);
    height: auto;
    max-height: 80%;
    top: 50%;
    left: 50%;
    margin-right: -50%;
    transform: translate(-50%, -50%);
  }

  .text-svg {
    position: absolute;
    fill: var(--dark);
    max-width: 18rem;
    transition: fill 300ms ease-in-out;
  }

  .icon-svg {
    position: absolute;
    fill: var(--light);
    width: calc(100% - 2rem);
    height: auto;
    max-height: 80%;
    top: 50%;
    left: 50%;
    margin-right: -50%;
    transform: translate(-50%, -50%);
    transition: fill 300ms ease-in-out;
  }
</style>

<menu
  in:fade={{ delay: $animationInDelay, duration: $animationInDuration, easing: $animationInEasing }}
  out:fade={{ duration: $animationOutDuration, easing: $animationOutEasing }}>
  <button
    on:click={() => setActiveMusicTab(get(musicActiveTab))}
    on:click={() => handleServicesModalClick('music', get(musicActiveTab))}
    aria-label="Toggle music submenu"
    aria-pressed={$servicesModalActive === 'music'}
    class:button-is-clicked={$servicesModalActive === 'music'}>
    <svg
      class="icon-svg"
      id="svg-to-animate-music"
      viewBox="0 0 148 148"
      xmlns="http://www.w3.org/2000/svg">
      <path
        d="M8,8V140H140V8ZM127,99.32c0,15.55-11.7,23.18-22.4,23.18-9,0-17.6-5.45-17.6-16.16C87,94,102.12,82.7,117,85.63v-41L60,56.3V109c0,15.58-11.82,23.23-22.62,23.23-9.09,0-17.46-5.43-17.46-16.13,0-12.44,15.16-23.77,30.08-20.82V32.79l77-17.25Z" />
    </svg>

    <svg
      class="text-svg"
      preserveAspectRatio="none"
      viewBox="0 0 132 34"
      xmlns="http://www.w3.org/2000/svg">
      <path
        d="M33.1686 1.04846V33.0015H27.4101V16.6256L20.0393
        33.0015H13.1292L5.75843 16.6755V33.0015H0V1.04846H5.75843L16.5613
        25.3128L27.4101 1.04846H33.1686Z" />
      <path
        d="M64.0125 1.04846V17.025C64.0125 23.4821 62.7917 27.9256 60.3502
        30.3554C57.924 32.7851 54.7376 34 50.7912 34C48.1653 34 45.885 33.5507
        43.9502 32.652C42.0307 31.72 40.4797 30.0059 39.2973 27.5095C38.1303
        24.9799 37.5468 21.4851 37.5468 17.025V1.04846H43.3052V14.7783C43.3052
        17.3744 43.5893 19.3882 44.1575 20.8194C44.741 22.2173 45.5702 23.1826
        46.6451 23.7151C47.72 24.2477 49.102 24.5139 50.7912 24.5139C52.4342
        24.5139 53.7932 24.2477 54.8681 23.7151C55.9431 23.1826 56.7723 22.2007
        57.3558 20.7695C57.9547 19.3382 58.2541 17.3412 58.2541
        14.7783V1.04846H64.0125Z" />
      <path
        d="M73.8724 21.2687C74.026 22.3005 74.6402 23.0994 75.7151 23.6652C76.79
        24.231 78.2181 24.5139 79.9994 24.5139C81.1818 24.5139 82.0955 24.4474
        82.7404 24.3142C83.3853 24.1478 83.846 23.8815 84.1224 23.5154C84.4142
        23.116 84.5601 22.5835 84.5601 21.9178C84.5601 21.2854 84.3297 20.8027
        83.869 20.4699C83.4237 20.1038 82.6483 19.8541 81.5426 19.721C80.4524
        19.5879 78.8477 19.5213 76.7286 19.5213C73.6574 19.5213 71.4232 18.8722
        70.0258 17.5742C68.6284 16.2428 67.9297 14.1126 67.9297 11.1836C67.9297
        7.42242 68.8203 4.62653 70.6016 2.79589C72.3982 0.931963 75.1086 0
        78.7325 0C82.2644 0 84.9593 1.11503 86.8174 3.34508C88.6908 5.54185
        89.6275 8.72051 89.6275 12.8811H83.6617C83.585 11.7827 83.1089 10.9506
        82.2337 10.3847C81.3584 9.78561 80.1145 9.48605 78.5022 9.48605C76.8745
        9.48605 75.6767 9.7024 74.9089 10.1351C74.1565 10.5345 73.7803 11.2002
        73.7803 12.1322C73.7803 12.7978 73.9799 13.2971 74.3792 13.63C74.7784
        13.9628 75.4924 14.1958 76.5213 14.3289C77.5501 14.4621 79.0934 14.5286
        81.1511 14.5286C83.3316 14.5286 85.0822 14.8448 86.4028 15.4772C87.7234
        16.0764 88.6831 17.0083 89.282 18.2731C89.8809 19.5046 90.1803 21.1189
        90.1803 23.116C90.1803 25.6789 89.8041 27.7592 89.0516 29.3568C88.3146
        30.9212 87.1475 32.0861 85.5505 32.8517C83.9689 33.6172 81.8881 34
        79.3084 34C76.8975 34 74.8091 33.5007 73.0432 32.5022C71.2773 31.4704
        69.926 30.0059 68.9893 28.1087C68.0526 26.1782 67.5842 23.8982 67.5842
        21.2687H73.8724Z" />
      <path d="M99.9619 1.04846V33.0015H94.2035V1.04846H99.9619Z" />
      <path
        d="M131.977 19.6711C131.854 24.464 130.71 28.0587 128.545
        30.4552C126.395 32.8184 123.147 34 118.802 34C115.654 34 113.036 33.5007
        110.947 32.5022C108.874 31.5037 107.269 29.7895 106.133 27.3598C105.012
        24.8967 104.452 21.535 104.452 17.2746C104.452 13.0142 105.012 9.61919
        106.133 7.08957C107.269 4.55996 108.882 2.7626 110.97 1.6975C113.074
        0.599118 115.684 0.0499259 118.802 0.0499259C123.101 0.0499259 126.341
        1.33138 128.522 3.89427C130.718 6.42389 131.877 10.1185 132
        14.978H126.011C125.689 13.2139 124.99 11.8659 123.915 10.9339C122.84
        10.002 121.136 9.53598 118.802 9.53598C116.805 9.53598 115.201 9.80225
        113.988 10.3348C112.775 10.8341 111.884 11.6495 111.316 12.7812C110.748
        13.9129 110.463 15.4107 110.463 17.2746C110.463 19.0054 110.748 20.4033
        111.316 21.4684C111.884 22.5002 112.775 23.2658 113.988 23.7651C115.216
        24.2643 116.821 24.5139 118.802 24.5139C121.105 24.5139 122.794 24.0813
        123.869 23.2159C124.959 22.3505 125.666 21.1689 125.988 19.6711H131.977Z" />
    </svg>
  </button>
  <button
    on:click={() => setActiveFilmTab(get(filmActiveTab))}
    on:click={() => handleServicesModalClick('film', get(filmActiveTab))}
    aria-label="Toggle film submenu"
    aria-pressed={$servicesModalActive === 'film'}
    class:button-is-clicked={$servicesModalActive === 'film'}>
    <svg
      class="icon-svg"
      id="svg-to-animate-film"
      viewBox="0 0 148 148"
      xmlns="http://www.w3.org/2000/svg">
      <path
        d="M113,24l11.58,7.75-14.47,2.88L98.47,26.86ZM70,32.51l11.6,7.77L96,37.4l-11.6-7.76ZM67.52,43.07,55.91,35.3,41.42,38.17,53.05,46ZM53.33,54,43.13,64H58.4L68.6,54ZM64,112.17,93,94.83,64,78.33ZM97.69,54H82.42L72.23,64H87.5Zm29.06,0H111.48L101.29,64h15.27ZM140,8V140H8V8ZM70.45,49,132,36.34l0-.2-4.87-20.9L24.77,35.47A10.88,10.88,0,0,0,16,46.12V116.5A14.5,14.5,0,0,0,30.5,131h87A14.5,14.5,0,0,0,132,116.5V49Z" />
    </svg>

    <svg
      class="text-svg"
      preserveAspectRatio="none"
      viewBox="0 0 132 34"
      xmlns="http://www.w3.org/2000/svg">
      <path
        d="M8.08584
        10.0938V14.6094H28.1387V23.6406H8.08584V34H0V0H32.6021V10.0938H8.08584Z" />
      <path d="M46.6692 0V34H38.5833V0H46.6692Z" />
      <path d="M80.239 23.9062V34H53.297V0H61.3829V23.9062H80.239Z" />
      <path
        d="M132 0V34H123.914V16.575L113.564 34H103.861L93.5114
        16.6281V34H85.4256V0H93.5114L108.68 25.8188L123.914 0H132Z" />
    </svg>
  </button>
  <button
    on:click={() => setActiveGameTab(get(gameActiveTab))}
    on:click={() => handleServicesModalClick('game', get(gameActiveTab))}
    aria-label="Toggle game submenu"
    aria-pressed={$servicesModalActive === 'game'}
    class:button-is-clicked={$servicesModalActive === 'game'}>
    <svg
      class="icon-svg"
      id="svg-to-animate-game"
      viewBox="0 0 148 148"
      xmlns="http://www.w3.org/2000/svg">
      <path
        d="M49.83,50a14.46,14.46,0,1,0,14.5,14.45A14.47,14.47,0,0,0,49.83,50Zm0,22.88a8.43,8.43,0,1,1,8.46-8.43A8.45,8.45,0,0,1,49.83,72.91Zm43.5-18.07a4.84,4.84,0,1,1,4.84,4.82A4.82,4.82,0,0,1,93.33,54.84Zm0,9.64a4.83,4.83,0,1,1-4.83-4.82A4.82,4.82,0,0,1,93.33,64.48ZM103,74.12a4.84,4.84,0,1,1-4.83-4.82A4.83,4.83,0,0,1,103,74.12Zm9.67-9.64a4.84,4.84,0,1,1-4.84-4.82A4.83,4.83,0,0,1,112.67,64.48ZM8,8V140H140V8ZM120.06,117.09c-8.06,0-11.64-5.6-15.34-11.4-4-6.23-8.1-12.69-18.09-12.69H61.36c-10,0-14.11,6.46-18.09,12.69-3.7,5.8-7.28,11.4-15.34,11.4S16,109.83,16,99.5c0-19.15,5.64-69.14,30.82-69.14,4,0,6.93,1.29,10.21,2.74A37.26,37.26,0,0,0,74,37,36.62,36.62,0,0,0,91,33.1c3.23-1.45,6.11-2.74,10.19-2.74,25.18,0,30.83,50,30.83,69.14C132,109.84,128,117.09,120.06,117.09Z" />
    </svg>

    <svg
      class="text-svg"
      preserveAspectRatio="none"
      viewBox="0 0 132 34"
      xmlns="http://www.w3.org/2000/svg">
      <path
        d="M30.4224 33H25.4945C25.4945 30.9667 25.8046 28 26.4248 24.1C25.5699
        27.1667 24.1535 29.5833 22.1757 31.35C20.2146 33.1167 17.7925 34 14.9095
        34C10.1324 34 6.45324 32.7667 3.87194 30.3C1.29065 27.8 0 23.45 0
        17.25C0 10.9833 1.34093 6.55 4.0228 3.95C6.72142 1.31667 10.6017 0
        15.6638 0C18.7144 0 21.2957 0.566666 23.4077 1.7C25.5364 2.8 27.1539 4.4
        28.2602 6.5C29.3664 8.56667 29.9698 11.05 30.0704 13.95H23.5334C22.6785
        10.9833 20.0553 9.5 15.6638 9.5C13.4848 9.5 11.7332 9.76667 10.409
        10.3C9.08482 10.8 8.11264 11.6167 7.49246 12.75C6.87228 13.8833 6.56219
        15.3833 6.56219 17.25C6.56219 19.75 7.30808 21.5833 8.79987
        22.75C10.2917 23.9167 12.7472 24.5 16.1666 24.5C20.0218 24.5 23.0305
        23.5667 25.1928 21.7H17.0215V16.45H30.4224V33Z" />
      <path
        d="M53.8513 28.15H42.1852L40.6012 33H33.687L44.4731
        0.999999H51.4627L62.3494 33H55.4352L53.8513 28.15ZM51.4125 20.65L47.9931
        10.15L44.5988 20.65H51.4125Z" />
      <path
        d="M101.827 0.999999V33H95.5414V16.6L87.4958 33H79.9531L71.9075
        16.65V33H65.6219V0.999999H71.9075L83.6993 25.3L95.5414 0.999999H101.827Z" />
      <path
        d="M132
        23.5V33H106.606V0.999999H131.95V10.5H112.892V14.5H128.48V19.5H112.892V23.5H132Z" />
    </svg>
  </button>
  <button
    on:click={() => setActiveBrandingTab(get(brandingActiveTab))}
    on:click={() => handleServicesModalClick('branding', get(brandingActiveTab))}
    aria-label="Toggle branding submenu"
    aria-pressed={$servicesModalActive === 'branding'}
    class:button-is-clicked={$servicesModalActive === 'branding'}
    class="last-button">
    <svg
      class="icon-svg"
      id="svg-to-animate-branding"
      viewBox="0 0 148 148"
      xmlns="http://www.w3.org/2000/svg">
      <path
        d="M83.92,62.67a7.25,7.25,0,1,1,7.25,7.09A7.17,7.17,0,0,1,83.92,62.67ZM57.33,69.76a7.09,7.09,0,1,0-7.25-7.09A7.16,7.16,0,0,0,57.33,69.76Zm16.92,23a41,41,0,0,1-26.62-9.13L45.25,86c5.45,8.13,15.47,16.85,29,16.85s23.55-8.72,29-16.85l-2.38-2.33A41,41,0,0,1,74.25,92.79ZM140,8V140H8V8Zm-7.75,66.49c0-31.32-26-56.71-58-56.71s-58,25.39-58,56.71,26,56.71,58,56.71S132.25,105.81,132.25,74.49Z" />
    </svg>

    <svg
      class="text-svg"
      preserveAspectRatio="none"
      viewBox="0 0 132 34"
      xmlns="http://www.w3.org/2000/svg">
      <path
        d="M11.1175 16.8C12.2592 16.9667 13.1249 17.5667 13.7144 18.6C14.304
        19.6 14.5988 21.3833 14.5988 23.95C14.5988 26.9833 14.1543 29.25 13.2653
        30.75C12.3762 32.25 11.1363 33 9.54537 33H0V0.999999H8.8435C10.0788
        0.999999 11.0801 1.28333 11.8475 1.85C12.6242 2.38333 13.1997 3.28333
        13.5741 4.55C13.9578 5.78333 14.1496 7.43333 14.1496 9.5C14.1496 11.8
        13.8969 13.5167 13.3916 14.65C12.8862 15.75 12.1282 16.4667 11.1175
        16.8ZM3.50933 10.4V14.6H8.9558C9.45178 14.6 9.8074 14.4333 10.0226
        14.1C10.2472 13.7667 10.3595 13.2333 10.3595 12.5C10.3595 11.7667
        10.2472 11.2333 10.0226 10.9C9.8074 10.5667 9.45178 10.4 8.9558
        10.4H3.50933ZM9.54537 23.6C10.0414 23.6 10.397 23.4333 10.6122
        23.1C10.8368 22.7667 10.9491 22.2333 10.9491 21.5C10.9491 20.7667
        10.8368 20.2333 10.6122 19.9C10.397 19.5667 10.0414 19.4 9.54537
        19.4H3.50933V23.6H9.54537Z" />
      <path
        d="M29.684 20.95C30.4607 21.2167 30.9941 21.7333 31.2842 22.5C31.5837
        23.2667 31.7334 24.4833 31.7334 26.15V33H28.2241V27.65C28.2241 26.5833
        28.1679 25.8167 28.0556 25.35C27.9433 24.85 27.7141 24.5 27.3678
        24.3C27.0216 24.1 26.4647 24 25.6974
        24H20.2088V33H16.6995V0.999999H27.5503C28.9353 0.999999 30.0302 1.86667
        30.835 3.6C31.6492 5.3 32.0563 8.1 32.0563 12C32.0563 14.7333 31.8457
        16.8 31.4246 18.2C31.0128 19.5667 30.4326 20.4833 29.684 20.95ZM27.5503
        15.65C27.8591 15.65 28.1024 15.4833 28.2802 15.15C28.458 14.7833 28.5469
        14.15 28.5469 13.25C28.5469 11.75 28.2147 11 27.5503
        11H20.2088V15.65H27.5503Z" />
      <path
        d="M45.1169 28.15H38.6036L37.7192 33H33.859L39.881
        0.999999H43.7833L49.8615 33H46.0012L45.1169 28.15ZM43.7553 20.65L41.8462
        10.15L39.9511 20.65H43.7553Z" />
      <path
        d="M67.9718 0.999999V33H64.4625L55.1979
        13.9V33H51.6885V0.999999H55.1979L64.4625 20.45V0.999999H67.9718Z" />
      <path
        d="M80.743 0.999999C84.9729 0.999999 87.0879 6.33333 87.0879 17C87.0879
        20 86.882 22.7 86.4702 25.1C86.0585 27.4667 85.38 29.3833 84.4348
        30.85C83.4896 32.2833 82.259 33 80.743
        33H70.6361V0.999999H80.743ZM80.6026 23C81.632 23 82.362 22.5167 82.7924
        21.55C83.2229 20.5833 83.4382 19.0667 83.4382 17C83.4382 14.9333 83.2229
        13.4167 82.7924 12.45C82.362 11.4833 81.632 11 80.6026
        11H74.1455V23H80.6026Z" />
      <path d="M93.3311 0.999999V33H89.8217V0.999999H93.3311Z" />
      <path
        d="M112.491 0.999999V33H108.982L99.7169
        13.9V33H96.2076V0.999999H99.7169L108.982 20.45V0.999999H112.491Z" />
      <path
        d="M132 33H129.249C129.249 30.9667 129.422 28 129.768 24.1C129.291
        27.1667 128.5 29.5833 127.396 31.35C126.301 33.1167 124.949 34 123.339
        34C120.672 34 118.618 32.7667 117.177 30.3C115.735 27.8 115.015 23.45
        115.015 17.25C115.015 10.9833 115.764 6.55 117.261 3.95C118.767 1.31667
        120.934 0 123.76 0C125.463 0 126.904 0.566666 128.084 1.7C129.272 2.8
        130.175 4.4 130.793 6.5C131.41 8.56667 131.747 11.05 131.803
        13.95H128.154C127.677 10.9833 126.212 9.5 123.76 9.5C122.544 9.5 121.566
        9.76667 120.826 10.3C120.087 10.8 119.544 11.6167 119.198 12.75C118.852
        13.8833 118.679 15.3833 118.679 17.25C118.679 19.75 119.095 21.5833
        119.928 22.75C120.761 23.9167 122.132 24.5 124.041 24.5C126.193 24.5
        127.873 23.5667 129.08 21.7H124.518V16.45H132V33Z" />
    </svg>
  </button>
</menu>
